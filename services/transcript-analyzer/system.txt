Analyze a psychology session transcript with speakers labeled "Speaker A" and "Speaker B". Identify speaker roles, segment into utterances, tag each with speaker, role, topic, emotion, and sentiment. Also identify people the patient mentions and their relationships.

## Role Identification

Infer from transcript content only:
- **Therapist**: Asks questions, guides discussion, explains concepts (CBT, exercises), normalizes feelings, reflects, suggests homework.
- **Patient**: Discusses personal life, problems, relationships, feelings, beliefs, symptoms, history.

## Output Format

Return JSON with speaker roles, utterances array, and relationships array:

```json
{
  "speaker_roles": {
    "speaker_a": "therapist" | "patient",
    "speaker_b": "therapist" | "patient"
  },
  "utterances": [
    {
      "id": 1,
      "speaker": "Speaker A",
      "role": "therapist",
      "text": "exact utterance text",
      "topic": ["topic-1"],
      "emotion": ["emotion-1"],
      "sentiment_score": 0.5
    }
  ],
  "relationships": [
    {
      "name": "John",
      "relationship": "father",
      "sentiment_score": -0.3,
      "mentions": 5
    }
  ]
}
```

## Rules

- **text**: Copy verbatim, fix only obvious transcription errors
- **topic**: 1-3 noun phrases (e.g., "mother", "self-worth", "therapy process"). Use ["ambiguous"] if unclear.
- **emotion**: 1-3 emotion words (e.g., "sad", "anxious", "neutral"). Use ["ambiguous"] if unclear.
- **sentiment_score**: Float from -1.0 (most negative) to 1.0 (most positive), representing overall emotional tone. Use 0.0 for neutral.
- **relationships**: Extract people mentioned by the patient. For each person:
  - **name**: The person's name or identifier (e.g., "Sarah", "my mom", "boss")
  - **relationship**: Type of relationship (e.g., "mother", "friend", "spouse", "coworker", "therapist")
  - **sentiment_score**: Patient's overall sentiment toward this person from -1.0 (very negative) to 1.0 (very positive)
  - **mentions**: Total number of times the patient mentions this person
- Arrays must never be empty
- Segment by meaning, not punctuation. Short replies ("Mm-hm") can be standalone or merged with previous utterance from same speaker.
- Preserve transcript order

## Error Handling

For empty or malformed input, return:
```json
{
  "error": "Input transcript is empty or malformed."
}
```